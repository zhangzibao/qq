require("common/manifest.js");
require("common/vendor.js");
global.webpackJsonp([2],[,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(4)),a=c(n(2)),s=c(n(12)),i=c(n(13)),o=c(n(15)),u=c(n(16));function c(e){return e&&e.__esModule?e:{default:e}}r.default.use(a.default),t.default=new a.default.Store({state:s.default,mutations:i.default,getters:o.default,actions:u.default})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=o(n(4)),s=o(n(8)),i=o(n(5));function o(e){return e&&e.__esModule?e:{default:e}}a.default.prototype.$store=i.default,a.default.config.productionTip=!1,s.default.mpType="app",new a.default(r({},s.default)).$mount()},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),a=n.n(r);var s=function(e){n(9)},i=n(0)(a.a,null,s,null,null);t.default=i.exports},function(e,t){},,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(2);t.default={computed:r({},(0,a.mapState)(["friends"])),onLaunch:function(){var t=this;e.onSocketOpen(function(e){t.changesocket(!0)}),e.onSocketError(function(e){}),e.onSocketClose(function(e){t.changesocket(!1)}),e.onSocketMessage(function(e){if("连接成功"!==e.data){var n=JSON.parse(e.data),r={friendId:n.userId,messageContent:n.messageContent,isreceive:!0};void 0===t.friends.find(function(e){return e.id===r.friendId})?t.$store.dispatch("updateData"):t.changeList(r)}})},onShow:function(){},onHide:function(){try{e.setStorageSync("userInfo",this.$store.state)}catch(e){}},methods:r({},(0,a.mapMutations)(["changeList","changesocket"]))}}).call(t,n(1).default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={hasLogin:!1,user_id:0,Authorization:"",socketOpen:!1,friends:[],self:{},activeId:0,isAjax:!1,messageList:{},messageListFB:{},stranger:{}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(14),s=(r=a)&&r.__esModule?r:{default:r};var i={logout:function(t){t.hasLogin=!1,e.closeSocket();try{e.removeStorageSync("userInfo")}catch(e){}},getself:function(e,t){e.self=t},getfriends:function(e,t){e.friends=t},changefriend:function(e,t){var n=t.friendId,r=t.value;e.friends.forEach(function(e){if(e.id===n)return e.uAvatar=r,void console.log()})},changeSelf:function(e,t){e.self.uAvatar=t},setMessageList:function(e,t){e.messageList=e.messageListFB=t},changesocket:function(e,t){e.socketOpen=t},getActiveId:function(e,t){e.activeId=t},setStranger:function(e,t){e.stranger=t},changeList:function(e,t){var n=s.default.nowDate("yyyy-mm-dd hh:mm:ss");void 0===e.messageList.find(function(e){return e.friendId===t.friendId})&&e.messageList.push({friendId:t.friendId,list:[]}),t.isreceive,e.messageList.forEach(function(e,r,a){e.friendId===t.friendId&&e.list.push({isreceive:t.isreceive,messageContent:t.messageContent,addTime:n})})},removeMessage:function(e,t){var n=t.id;e.messageList.forEach(function(e,t,r){e.friendId===n&&r.splice(t,1)})}};t.default=i}).call(t,n(1).default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={nowDate:function(e){var t=Date.now();function n(e){return e<10?"0"+e:e}var r=new Date(parseInt(t)),a=r.getFullYear(),s=r.getMonth()+1,i=r.getDate(),o=r.getHours(),u=r.getMinutes(),c=r.getSeconds();return"yyyy-mm-dd hh:mm:ss"==e?a+"-"+n(s)+"-"+n(i)+" "+n(o)+":"+n(u)+":"+n(c):a+"-"+n(s)+"-"+n(i)},formatTimeStamp:function(e,t){var n={"M+":(t=new Date(parseInt(t))).getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e},formatSyl:function(e){return e||(e=0),0==e?"--":e.toFixed(2)},formatVol:function(e){return 0==e?"--":e.toFixed(0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={friend:function(e){if(e.friends.length>0)return e.friends.find(function(t){return t.id===e.activeId})},nowMessageList:function(e){return e.messageList.find(function(t){return t.friendId===e.activeId})?e.messageList.find(function(t){return t.friendId===e.activeId}).list:[]}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(17)),a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(a)throw s}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,s){try{var i=t[a](s),o=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(o).then(function(e){r("next",e)},function(e){r("throw",e)});e(o)}("next")})}}var u={Login:function(t,n){var s=this,i=t.commit,u=t.state;return o(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.request({url:"http://120.79.44.150:8080/myqqServer/api/user/"+n.user_id}).then(function(e){var t=a(e,2),n=(t[0],t[1]);u.self=n.data});case 2:return t.next=4,e.request({url:"http://120.79.44.150:8080/myqqServer/api/friends/"+n.user_id}).then(function(e){var t=a(e,2),n=(t[0],t[1]);u.friends=n.data});case 4:return t.next=6,e.request({url:"http://120.79.44.150:8080/myqqServer/api/message/"+n.user_id}).then(function(e){var t=a(e,2),n=(t[0],t[1]);i("setMessageList",n.data)});case 6:u.Authorization=n.token,u.user_id=n.user_id,u.hasLogin=!0,u.isAjax=!0;try{e.setStorageSync("userInfo",u)}catch(e){}case 11:case"end":return t.stop()}},t,s)}))()},updateData:function(t){var n=this,s=t.commit,i=t.state;return o(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.request({url:"http://120.79.44.150:8080/myqqServer/api/friends/"+i.user_id}).then(function(e){var t=a(e,2),n=(t[0],t[1]);i.friends=n.data});case 2:return t.next=4,e.request({url:"http://120.79.44.150:8080/myqqServer/api/message/"+i.user_id}).then(function(e){var t=a(e,2),n=(t[0],t[1]);s("setMessageList",n.data)});case 4:try{e.setStorageSync("userInfo",i)}catch(e){}case 5:case"end":return t.stop()}},t,n)}))()},addMessage:function(t,n){var i=this,u=t.commit,c=n.friendId,d=n.isreceive,f=n.messageContent;return o(r.default.mark(function t(){var n,o,l;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=s.default.state.user_id,o={userId:n,friendId:c,isreceive:d,messageContent:f},l={userId:c,friendId:n,isreceive:!d,messageContent:f},e.request({url:"http://120.79.44.150:8080/myqqServer/api/addmessage",data:o,method:"POST",header:{"content-type":"application/json"}}).then(function(e){var t=a(e,2);t[0];1===t[1].data?u("changeList",{friendId:c,messageContent:f,isreceive:d}):u("changeList",{friendId:c,messageContent:"发送失败",isreceive:d})}),e.request({url:"http://120.79.44.150:8080/myqqServer/socket/push/"+c,data:{userId:n,messageContent:f},header:{"content-type":"application/json"},method:"POST"}).then(function(e){var t=a(e,2);t[0];t[1].statusCode}),e.request({url:"http://120.79.44.150:8080/myqqServer/api/addmessage",data:l,method:"POST",header:{"content-type":"application/json"}}).then(function(e){var t=a(e,2);t[0];t[1].data});case 6:case"end":return t.stop()}},t,i)}))()},sendRobotValue:function(t,n){var s=this,i=t.commit,u=n.friendId,c=n.messageContent,d=n.isreceive;return o(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i("changeList",{friendId:u,messageContent:c,isreceive:d}),e.request({url:"http://120.79.44.150:8080/myqqServer/api/robot",data:{info:c,userid:u},header:{"content-type":"application/json"},method:"POST"}).then(function(e){var t=a(e,2),n=(t[0],t[1].data);if(1e5===n.code)i("changeList",{friendId:u,messageContent:n.text,isreceive:!d});else if(2e5===n.code){var r=n.text+n.url;i("changeList",{friendId:u,messageContent:r,isreceive:!d})}else n.code,i("changeList",{friendId:u,messageContent:"暂不支持此类对话",isreceive:!d})});case 2:case"end":return t.stop()}},t,s)}))()},addnewfriend:function(t){var n=this,s=t.state;return o(r.default.mark(function t(){var i,o;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i={userId:s.self.id,friendId:s.stranger.id},o={userId:s.stranger.id,friendId:s.self.id},s.friends.push(s.stranger),s.stranger={},e.request({url:"http://120.79.44.150:8080/myqqServer/api/friends",data:i,method:"POST",header:{"content-type":"application/json"}}).then(function(e){var t=a(e,2),n=t[0];1===t[1].data||console.log(n)}),e.request({url:"http://120.79.44.150:8080/myqqServer/api/friends",data:o,method:"POST",header:{"content-type":"application/json"}}).then(function(e){var t=a(e,2);t[0];t[1].data});case 6:case"end":return t.stop()}},t,n)}))()}};t.default=u}).call(t,n(1).default)}],[6]);